<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_131) on Thu Jun 22 07:28:19 UTC 2017 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>OptimisticTransactionalContext (corfu 0.1-3466 API)</title>
<meta name="date" content="2017-06-22">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="OptimisticTransactionalContext (corfu 0.1-3466 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/OptimisticTransactionalContext.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/corfudb/runtime/object/transactions/SnapshotTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html" target="_top">Frames</a></li>
<li><a href="OptimisticTransactionalContext.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#fields.inherited.from.class.org.corfudb.runtime.object.transactions.AbstractTransactionalContext">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.corfudb.runtime.object.transactions</div>
<h2 title="Class OptimisticTransactionalContext" class="title">Class OptimisticTransactionalContext</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">org.corfudb.runtime.object.transactions.AbstractTransactionalContext</a></li>
<li>
<ul class="inheritance">
<li>org.corfudb.runtime.object.transactions.OptimisticTransactionalContext</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html?is-external=true" title="class or interface in java.lang">Comparable</a>&lt;<a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a>&gt;</dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../../org/corfudb/runtime/object/transactions/WriteAfterWriteTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">WriteAfterWriteTransactionalContext</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">OptimisticTransactionalContext</span>
extends <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></pre>
<div class="block">A Corfu optimistic transaction context.

 <p>Optimistic transactions in Corfu provide the following isolation guarantees:

 <p>(1) Read-your-own Writes:
  Reads in a transaction are guaranteed to observe a write in the same
  transaction, if a write happens before
      the read.

 <p>(2) Opacity:
  Read in a transaction observe the state of the system ("snapshot") as of the time of the
      first read which occurs in the transaction ("first read
      timestamp"), except in case (1) above where they observe the own tranasction's writes.

 <p>(3) Atomicity:
  Writes in a transaction are guaranteed to commit atomically,
     and commit if and only if none of the objects which were
     read (the "read set") were modified between the first read
     ("first read timestamp") and the time of commit.

 <p>Created by mwei on 4/4/16.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.org.corfudb.runtime.object.transactions.AbstractTransactionalContext">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;org.corfudb.runtime.object.transactions.<a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></h3>
<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#ABORTED_ADDRESS">ABORTED_ADDRESS</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#builder">builder</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#commitAddress">commitAddress</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#completionFuture">completionFuture</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#FOLDED_ADDRESS">FOLDED_ADDRESS</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#NOWRITE_ADDRESS">NOWRITE_ADDRESS</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#startTime">startTime</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#transactionID">transactionID</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#UNCOMMITTED_ADDRESS">UNCOMMITTED_ADDRESS</a></code></li>
</ul>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>&lt;R,T&gt;&nbsp;R</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#access-org.corfudb.runtime.object.ICorfuSMRProxyInternal-org.corfudb.runtime.object.ICorfuSMRAccess-java.lang.Object:A-">access</a></span>(<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&lt;T&gt;&nbsp;proxy,
      <a href="../../../../../org/corfudb/runtime/object/ICorfuSMRAccess.html" title="interface in org.corfudb.runtime.object">ICorfuSMRAccess</a>&lt;R,T&gt;&nbsp;accessFunction,
      <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>[]&nbsp;conflictObject)</code>
<div class="block">Access within optimistic transactional context is implemented
 in via proxy.access() as follows:</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#addTransaction-org.corfudb.runtime.object.transactions.AbstractTransactionalContext-">addTransaction</a></span>(<a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a>&nbsp;tc)</code>
<div class="block">Commit a transaction into this transaction by merging the read/write
 sets.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#commitTransaction--">commitTransaction</a></span>()</code>
<div class="block">Commit the transaction.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#getConflictSetAndCommit-java.util.function.Supplier-">getConflictSetAndCommit</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html?is-external=true" title="class or interface in java.util.function">Supplier</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>,<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&gt;&gt;&nbsp;computeConflictSet)</code>
<div class="block">Commit with a given conflict set and return the address.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#getUpcallResult-org.corfudb.runtime.object.ICorfuSMRProxyInternal-long-java.lang.Object:A-">getUpcallResult</a></span>(<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&lt;T&gt;&nbsp;proxy,
               long&nbsp;timestamp,
               <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>[]&nbsp;conflictObject)</code>
<div class="block">if a Corfu object's method is an Accessor-Mutator, then although the mutation is delayed,
 it needs to obtain the result by invoking getUpcallResult() on the optimistic stream.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#logUpdate-org.corfudb.runtime.object.ICorfuSMRProxyInternal-org.corfudb.protocols.logprotocol.SMREntry-java.lang.Object:A-">logUpdate</a></span>(<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&lt;T&gt;&nbsp;proxy,
         <a href="../../../../../org/corfudb/protocols/logprotocol/SMREntry.html" title="class in org.corfudb.protocols.logprotocol">SMREntry</a>&nbsp;updateEntry,
         <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>[]&nbsp;conflictObjects)</code>
<div class="block">Logs an update.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#obtainSnapshotTimestamp--">obtainSnapshotTimestamp</a></span>()</code>
<div class="block">Get the first timestamp for this transaction.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#tryCommitAllProxies--">tryCommitAllProxies</a></span>()</code>
<div class="block">Try to commit the optimistic updates to each proxy.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html#updateAllProxies-java.util.function.Consumer-">updateAllProxies</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function">Consumer</a>&lt;<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&gt;&nbsp;function)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.corfudb.runtime.object.transactions.AbstractTransactionalContext">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.corfudb.runtime.object.transactions.<a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></h3>
<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#abortTransaction-org.corfudb.runtime.exceptions.TransactionAbortedException-">abortTransaction</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#addToReadSet-org.corfudb.runtime.object.ICorfuSMRProxyInternal-java.lang.Object:A-">addToReadSet</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#compareTo-org.corfudb.runtime.object.transactions.AbstractTransactionalContext-">compareTo</a>, <a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#toString--">toString</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="access-org.corfudb.runtime.object.ICorfuSMRProxyInternal-org.corfudb.runtime.object.ICorfuSMRAccess-java.lang.Object:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>access</h4>
<pre>public&nbsp;&lt;R,T&gt;&nbsp;R&nbsp;access(<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&lt;T&gt;&nbsp;proxy,
                      <a href="../../../../../org/corfudb/runtime/object/ICorfuSMRAccess.html" title="interface in org.corfudb.runtime.object">ICorfuSMRAccess</a>&lt;R,T&gt;&nbsp;accessFunction,
                      <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>[]&nbsp;conflictObject)</pre>
<div class="block">Access within optimistic transactional context is implemented
 in via proxy.access() as follows:

 <p>1. First, we try to grab a read-lock on the proxy, and hope to "catch" the proxy in the
 snapshot version. If this succeeds, we invoke the corfu-object access method, and
 un-grab the read-lock.

 <p>2. Otherwise, we grab a write-lock on the proxy and bring it to the correct
 version
 - Inside proxy.setAsOptimisticStream, if there are currently optimistic
 updates on the proxy, we roll them back.  Then, we set this
 transactional context as the proxy's new optimistic context.
 - Then, inside proxy.syncObjectUnsafe, depending on the proxy version,
 we may need to undo or redo committed changes, or apply forward committed changes.

 Access the state of the object.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#access-org.corfudb.runtime.object.ICorfuSMRProxyInternal-org.corfudb.runtime.object.ICorfuSMRAccess-java.lang.Object:A-">access</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>R</code> - The return type of the access function.</dd>
<dd><code>T</code> - The type of the proxy's underlying object.</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>proxy</code> - The proxy to access the state for.</dd>
<dd><code>accessFunction</code> - The function to execute, which will be provided with the state
                       of the object.</dd>
<dd><code>conflictObject</code> - Fine-grained conflict information, if available.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The return value of the access function.</dd>
</dl>
</li>
</ul>
<a name="getUpcallResult-org.corfudb.runtime.object.ICorfuSMRProxyInternal-long-java.lang.Object:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUpcallResult</h4>
<pre>public&nbsp;&lt;T&gt;&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;getUpcallResult(<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&lt;T&gt;&nbsp;proxy,
                                  long&nbsp;timestamp,
                                  <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>[]&nbsp;conflictObject)</pre>
<div class="block">if a Corfu object's method is an Accessor-Mutator, then although the mutation is delayed,
 it needs to obtain the result by invoking getUpcallResult() on the optimistic stream.

 <p>This is similar to the second stage of access(), accept working
 on the optimistic stream instead of the
 underlying stream.- grabs the write-lock on the proxy.
 - uses proxy.setAsOptimisticStream in order to set itself as the proxy optimistic context,
   including rolling-back current optimistic changes, if any.
 - uses proxy.syncObjectUnsafe to bring the proxy to the desired version,
   which includes applying optimistic updates of the current
  transactional context.

 Get the result of an upcall.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#getUpcallResult-org.corfudb.runtime.object.ICorfuSMRProxyInternal-long-java.lang.Object:A-">getUpcallResult</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - The type of the proxy's underlying object.</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>proxy</code> - The proxy to retrieve the upcall for.</dd>
<dd><code>timestamp</code> - The timestamp to return the upcall for.</dd>
<dd><code>conflictObject</code> - Fine-grained conflict information, if available.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The result of the upcall.</dd>
</dl>
</li>
</ul>
<a name="logUpdate-org.corfudb.runtime.object.ICorfuSMRProxyInternal-org.corfudb.protocols.logprotocol.SMREntry-java.lang.Object:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logUpdate</h4>
<pre>public&nbsp;&lt;T&gt;&nbsp;long&nbsp;logUpdate(<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&lt;T&gt;&nbsp;proxy,
                          <a href="../../../../../org/corfudb/protocols/logprotocol/SMREntry.html" title="class in org.corfudb.protocols.logprotocol">SMREntry</a>&nbsp;updateEntry,
                          <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>[]&nbsp;conflictObjects)</pre>
<div class="block">Logs an update. In the case of an optimistic transaction, this update
 is logged to the write set for the transaction.

 <p>Return the "address" of the update; used for retrieving results
 from operations via getUpcallRestult.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#logUpdate-org.corfudb.runtime.object.ICorfuSMRProxyInternal-org.corfudb.protocols.logprotocol.SMREntry-java.lang.Object:A-">logUpdate</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - The type of the proxy.</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>proxy</code> - The proxy making the request.</dd>
<dd><code>updateEntry</code> - The timestamp of the request.</dd>
<dd><code>conflictObjects</code> - Fine-grained conflict information, if available.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The "address" that the update was written to.</dd>
</dl>
</li>
</ul>
<a name="addTransaction-org.corfudb.runtime.object.transactions.AbstractTransactionalContext-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addTransaction</h4>
<pre>public&nbsp;void&nbsp;addTransaction(<a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a>&nbsp;tc)</pre>
<div class="block">Commit a transaction into this transaction by merging the read/write
 sets.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#addTransaction-org.corfudb.runtime.object.transactions.AbstractTransactionalContext-">addTransaction</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tc</code> - The transaction to merge.</dd>
</dl>
</li>
</ul>
<a name="commitTransaction--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commitTransaction</h4>
<pre>public&nbsp;long&nbsp;commitTransaction()
                       throws <a href="../../../../../org/corfudb/runtime/exceptions/TransactionAbortedException.html" title="class in org.corfudb.runtime.exceptions">TransactionAbortedException</a></pre>
<div class="block">Commit the transaction. If it is the last transaction in the stack,
 append it to the log, otherwise merge it into a nested transaction.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#commitTransaction--">commitTransaction</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The address of the committed transaction.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/corfudb/runtime/exceptions/TransactionAbortedException.html" title="class in org.corfudb.runtime.exceptions">TransactionAbortedException</a></code> - If the transaction was aborted.</dd>
</dl>
</li>
</ul>
<a name="getConflictSetAndCommit-java.util.function.Supplier-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConflictSetAndCommit</h4>
<pre>public&nbsp;long&nbsp;getConflictSetAndCommit(<a href="http://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html?is-external=true" title="class or interface in java.util.function">Supplier</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util">UUID</a>,<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&gt;&gt;&nbsp;computeConflictSet)</pre>
<div class="block">Commit with a given conflict set and return the address.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>computeConflictSet</code> - conflict set used to check whether transaction can commit</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the commit address</dd>
</dl>
</li>
</ul>
<a name="tryCommitAllProxies--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryCommitAllProxies</h4>
<pre>protected&nbsp;void&nbsp;tryCommitAllProxies()</pre>
<div class="block">Try to commit the optimistic updates to each proxy.</div>
</li>
</ul>
<a name="updateAllProxies-java.util.function.Consumer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateAllProxies</h4>
<pre>protected&nbsp;void&nbsp;updateAllProxies(<a href="http://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function">Consumer</a>&lt;<a href="../../../../../org/corfudb/runtime/object/ICorfuSMRProxyInternal.html" title="interface in org.corfudb.runtime.object">ICorfuSMRProxyInternal</a>&gt;&nbsp;function)</pre>
</li>
</ul>
<a name="obtainSnapshotTimestamp--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>obtainSnapshotTimestamp</h4>
<pre>public&nbsp;long&nbsp;obtainSnapshotTimestamp()</pre>
<div class="block">Get the first timestamp for this transaction.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html#obtainSnapshotTimestamp--">obtainSnapshotTimestamp</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions">AbstractTransactionalContext</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The first timestamp to be used for this transaction.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/OptimisticTransactionalContext.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/corfudb/runtime/object/transactions/AbstractTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/corfudb/runtime/object/transactions/SnapshotTransactionalContext.html" title="class in org.corfudb.runtime.object.transactions"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.html" target="_top">Frames</a></li>
<li><a href="OptimisticTransactionalContext.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#fields.inherited.from.class.org.corfudb.runtime.object.transactions.AbstractTransactionalContext">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2017 <a href="http://www.corfudb.org">CorfuDB</a>. All rights reserved.</small></p>
</body>
</html>
